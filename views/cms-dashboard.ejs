<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>

	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<meta name="author" content="SemiColonWeb" />

	<!-- Stylesheets
	============================================= -->
	<link href="http://fonts.googleapis.com/css?family=Poppins:300,400,400italic,600,700|Montserrat:400,700|Merriweather" rel="stylesheet" type="text/css" />
	<link rel="stylesheet" href="css-global/bootstrap.css" type="text/css" />
	<link rel="stylesheet" href="css/style.css" type="text/css" />
	<link rel="stylesheet" href="css-global/dark.css" type="text/css" />
	<!-- Media Agency Demo Specific Stylesheet -->
	<link rel="stylesheet" href="css/app-landing.css" type="text/css" />
	<!-- / -->
	<link rel="stylesheet" href="css-global/font-icons.css" type="text/css" />
	<link rel="stylesheet" href="css/et-line/et-line.css" type="text/css" />
	<link rel="stylesheet" href="css-global/animate.css" type="text/css" />
	<link rel="stylesheet" href="css-global/magnific-popup.css" type="text/css" />
	<link rel="stylesheet" href="css/fonts.css" type="text/css" />
	<!-- Bootstrap Switch CSS -->
	<link rel="stylesheet" href="css-global/components/bs-switches.css" type="text/css" />

	<link rel="stylesheet" href="css-global/responsive.css" type="text/css" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<!--[if lt IE 9]>
		<script src="http://css3-mediaqueries-js.googlecode.com/svn/trunk/css3-mediaqueries.js"></script>
	<![endif]-->
	<link rel="stylesheet" href="css/colors.css" type="text/css" />
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/sweetalert2/6.1.1/sweetalert2.min.css">
	<!-- Document Title
	============================================= -->

	<title><%= title %></title>

</head>

<body class="stretched">

	<!-- Document Wrapper
	============================================= -->
	<div id="wrapper" class="clearfix">

		<!-- Header
		============================================= -->

		<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
			<ul class="nav navbar-nav navbar-right nobottommargin">
			<li><a href="#"></a></li>
			<li class="dropdown">
				<a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Ivan Gerard <b class="caret"></b></a>
				<ul class="dropdown-menu" role="menu">
				<li><a href="#">Profile</a></li>
				<li><a href="#">My Transaction</a></li>

				<li class="divider"></li>
				<li><a href="#">Logout</a></li>
				</ul>
			</li>
			</ul>
		</div>

		<!-- Content
		============================================= -->
		<section id="content">

			<div class="content-wrap">

				<div class="container clearfix">

					<div class="row clearfix">

						<div class="col-sm-12">
							<h3>Superman Dashboard</h3>
							<div class="clear"></div>

							<div class="row clearfix">

								<div class="col-md-12">

									<div class="tabs tabs-alt clearfix" id="tabs-profile">

										<ul class="tab-nav clearfix">
											<li><a href="#tab-feeds"><i class="icon-note"></i> Transaction</a></li>
											<li><a href="#tab-user"><i class="icon-user4"></i> User</a></li>
											<li><a href="#tab-gudang"><i class="icon-home2"></i> Gudang</a></li>
										</ul>

										<div class="tab-container">

											<div class="tab-content clearfix" id="tab-feeds">

												<div class="table-responsive">
							<table class="table table-bordered table-striped">
							  <colgroup>
									<col class="col-xs-1">
									<col class="col-xs-2">
									<col class="col-xs-1">

									<col class="col-xs-1">

									<col class="col-xs-1">

									<col class="col-xs-1">

									<col class="col-xs-1">

							  </colgroup>
							  <thead>
								<tr>
									<th>Created At <br>
									<span style="font-size:12px">MM/DD/YYYY</span></th>
									<th>Warehouse Name</th>
									<th>Transactions</th>
									<th>Recipient</th>
									<th>Bank Name</th>
									<th>Status</th>
									<th>Action</th>
								</tr>
							  </thead>
							  <tbody id="list-transaction">

							  </tbody>
							</table>
						  </div>


											</div>


											<div class="tab-content clearfix" id="tab-gudang">

												<div class="row topmargin-sm clearfix">

													<div class="col-xs-12 bottommargin-sm">
														<div class="ipost clearfix">
															<div class="row clearfix">
																<div class="col-sm-4">
																	<div class="entry-image">
																		<a href="images/portfolio/full/17.jpg" data-lightbox="image"><img class="image_fade" src="images/blog/grid/17.jpg" alt="Standard Post with Image"></a>
																	</div>
																</div>
																<div class="col-sm-8">
																	<div class="entry-title">
																		<h3><a href="blog-single.html">This is a Standard post with a Preview Image</a></h3>
																	</div>
																	<ul class="entry-meta clearfix">
																		<li><i class="icon-calendar3"></i> 10th Feb 2014</li>
																		<li><a href="blog-single.html#comments"><i class="icon-comments"></i> 13</a></li>
																		<li><a href="#"><i class="icon-camera-retro"></i></a></li>
																	</ul>
																	<div class="entry-content">
																		<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Cupiditate, asperiores quod est tenetur in.</p>
																	</div>
																</div>
															</div>
														</div>
													</div>
													<div class="col-xs-12 bottommargin-sm">
														<div class="ipost clearfix">
															<div class="row clearfix">
																<div class="col-sm-4">
																	<div class="entry-image">
																		<div class="fslider" data-arrows="false">
																			<div class="flexslider">
																				<div class="slider-wrap">
																					<div class="slide"><img class="image_fade" src="images/blog/grid/10.jpg" alt="Standard Post with Gallery"></div>
																					<div class="slide"><img class="image_fade" src="images/blog/grid/20.jpg" alt="Standard Post with Gallery"></div>
																					<div class="slide"><img class="image_fade" src="images/blog/grid/21.jpg" alt="Standard Post with Gallery"></div>
																				</div>
																			</div>
																		</div>
																	</div>
																</div>
																<div class="col-sm-8">
																	<div class="entry-title">
																		<h3><a href="blog-single.html">This is a Standard post with a Slider Gallery</a></h3>
																	</div>
																	<ul class="entry-meta clearfix">
																		<li><i class="icon-calendar3"></i> 10th Feb 2014</li>
																		<li><a href="blog-single.html#comments"><i class="icon-comments"></i> 13</a></li>
																		<li><a href="#"><i class="icon-camera-retro"></i></a></li>
																	</ul>
																	<div class="entry-content">
																		<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Cupiditate, asperiores quod est tenetur in.</p>
																	</div>
																</div>
															</div>
														</div>
													</div>

												</div>

											</div>



										</div>

									</div>

								</div>

							</div>

						</div>

						<div class="line visible-xs-block"></div>



					</div>

				</div>

			</div>

		</section><!-- #content end -->

		<footer id="footer" style="background-color: #FFF;">

			<div class="container">

				<!-- Footer Widgets
				============================================= -->
				<div class="footer-widgets-wrap clearfix">
					<div class="row clearfix">

						<div class="col-md-5">

							<div class="widget clearfix">
								<div class="row clearfix">

									<div class="">
										Copyrights &copy; 2016 All Rights Reserved by ivangerard.com<br>
										<div class="copyright-links"><a href="#">Terms of Use</a> / <a href="#">Privacy Policy</a></div>
									</div>

								</div>
							</div>

						</div>



					</div>
				</div>

			</div>


		</footer>
	</div><!-- #wrapper end -->

	<!-- Go To Top
	============================================= -->
	<div id="gotoTop" class="icon-angle-up"></div>

	<!-- External JavaScripts
	============================================= -->
	<script type="text/javascript" src="js/jquery.js"></script>
	<script type="text/javascript" src="js/plugins.js"></script>
	<script src="https://cdn.jsdelivr.net/sweetalert2/6.1.1/sweetalert2.min.js"></script>
	<script type="text/javascript" src="js/components/bs-datatable.js"></script>

	<!-- Footer Scripts
	============================================= -->
	<script type="text/javascript" src="js/functions.js"></script>

	<script>
	$(document).ready(function() {

			listTransaction()



		jQuery( "#tabs-profile" ).on( "tabsactivate", function( event, ui ) {
			jQuery( '.flexslider .slide' ).resize();
		});
	});

	function listTransaction() {
		$.get({
				url: "/api/transactions/",
				success: function(result) {
					for (var k in result.data){
						for(var l =0 ;l<result.data[k].transactions.length;l++){
							var status
							if(result.data[k].transactions[l].status == "UnPaid"){
                    status =  `<span class="label label-default">Unpaid</span>`
						}else{
							status =  `<span class="label label-default">Paid</span>`
						}
						var date = new Date(result.data[k].transactions[l].createdAt)
						var getMonth = date.getMonth()+1
						var getDate = date.getDate()
						var getYear = date.getYear()+1900
							var listdataHTML =
							`
										<tr>
											<td>${getMonth+'-'+getDate+'-'+getYear}</td>
											<td>${result.data[k].name}
											<br /><span style="font-size:12px">PIC : ${result.data[k].transactions[l].userId.name}</span></td>
											<td>${result.data[k].transactions[l].nominal}</td>
											<td>${result.data[k].transactions[l].recipient}</td>
											<td>${result.data[k].transactions[l].bank}</td>
											<td>${status}</td>
											<td><a href="#" data-id='${result.data[k].transactions[l]._id}'class="remove update-trx"  title="Update this item"><i class="icon-pencil"></i></a></td>
										</tr>
							`
						}
						$('#list-transaction').prepend(listdataHTML)
						$(".update-trx").click(function() {


								updateTrx($(this).attr('data-id'))

						})

					}
				}
		})
	}


function updateTrx(id){
	console.log(id)
	swal({
  title: 'Are you sure?',
  text: "This status will change",
  type: 'warning',
  showCancelButton: true,
  confirmButtonColor: '#3085d6',
  cancelButtonColor: '#d33',
  confirmButtonText: 'Yes, Status Change!'
}).then(function () {
  swal(
    'Edited!',
    'Your status has been changed.',
    'success'
  ).then(function(){
		$.ajax({
				url: '/api/transactions/'+id,
				type: 'PUT',
				success: function(result) {
				}
		})
	})
})






	}

	</script>

</body>
</html>
